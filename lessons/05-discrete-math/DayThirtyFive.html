<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Day 35: Cryptography (RSA)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&family=DM+Sans:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
        onload="renderMathInElement(document.body);"></script>
    <link rel="stylesheet" href="../../lessons/shared-styles.css">
    <script src="../../lessons/questions-data.js"></script>
    <script src="../../lessons/shared-scripts.js"></script>
</head>

<body>
    <nav class="nav">
        <div class="nav-inner">
            <a href="../../index.html" class="nav-back">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10 12L6 8L10 4" />
                </svg>
                Back to Curriculum
            </a>
            <div class="nav-progress">
                <span id="progressText">0 / 27 complete</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                </svg>
            </button>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-label">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 0L10 6H16L11 9.5L13 16L8 12L3 16L5 9.5L0 6H6L8 0Z" />
            </svg>
            Day 35 · The Lock and The Key
        </div>
        <h1>Cryptography & RSA</h1>
        <p class="hero-desc">
            How can two strangers communicate secretly in a crowded room?
            Public Key Cryptography is the foundation of internet privacy (HTTPS).
        </p>
        <div class="hero-meta">
            <div class="meta-item">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 6v6l4 2" />
                </svg>
                ~105 min read
            </div>
            <div class="meta-item">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path
                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                </svg>
                40 practice problems
            </div>
            <div class="meta-item">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3" />
                </svg>
                12 video lessons
            </div>
        </div>
    </header>

    <div class="main-layout">
        <aside class="sidebar">
            <nav class="toc">
                <div class="toc-title">On this page</div>
                <ul class="toc-list">
                    <li><a href="#trust" class="toc-link">1. The Trust Problem</a></li>
                    <li><a href="#rsa-math" class="toc-link">2. RSA Mathematics</a></li>
                    <li><a href="#signatures" class="toc-link">3. Digital Signatures</a></li>
                    <li><a href="#hashing" class="toc-link">4. Hashing & Salting</a></li>
                    <li><a href="#python" class="toc-link">5. Python: Full RSA</a></li>
                    <li><a href="#videos" class="toc-link">6. Video Lessons</a></li>
                    <li><a href="#practice" class="toc-link">7. Practice Problems</a></li>
                </ul>
            </nav>
            <div class="stats-card">
                <div class="toc-title">Your Progress</div>
                <div class="stats-row"><span class="stats-label">Attempted</span><span class="stats-value"
                        id="statAttempted">0</span></div>
                <div class="stats-row"><span class="stats-label">Correct</span><span class="stats-value"
                        id="statCorrect">0</span></div>
                <div class="stats-row"><span class="stats-label">Accuracy</span><span class="stats-value"
                        id="statAccuracy">—</span></div>
            </div>
        </aside>

        <main class="content">
            <!-- Trust -->
            <section class="section" id="trust">
                <div class="section-header">
                    <div class="section-number">Section 1</div>
                    <h2 class="section-title">The Trust Problem</h2>
                </div>
                <div class="section-body">
                    <p>Cryptography is the study of secure communication in the presence of adversaries (Alice, Bob, and
                        Eve).</p>
                    <div class="grid-2col">
                        <div class="card">
                            <h3>Symmetric (The House Key)</h3>
                            <p><strong>One Key</strong> locks and unlocks.</p>
                            <p>PRO: Very fast (AES).</p>
                            <p>CON: How do you share the key safely?</p>
                        </div>
                        <div class="card">
                            <h3>Asymmetric (The Padlock)</h3>
                            <p><strong>Two Keys</strong>: Public (Lock) & Private (Key).</p>
                            <p>PRO: No need to hide the lock.</p>
                            <p>CON: Slow. CPU intensive.</p>
                        </div>
                    </div>
                    <div class="rule">
                        <strong>Diffie-Hellman Key Exchange (The Paint Analogy):</strong>
                        <br>How can two people agree on a secret color in public without revealing it?
                        <br>1. Public: Agree on "Yellow".
                        <br>2. Alice mixes "Red" (Private) + "Yellow" = "Orange".Sends "Orange".
                        <br>3. Bob mixes "Blue" (Private) + "Yellow" = "Green". Sends "Green".
                        <br>4. Alice adds "Red" to "Green" -> Brown.
                        <br>5. Bob adds "Blue" to "Orange" -> Brown.
                        <br>Result: Both have "Brown", but Eve only saw Orange and Green.
                    </div>
                </div>
            </section>

            <!-- RSA -->
            <section class="section" id="rsa-math">
                <div class="section-header">
                    <div class="section-number">Section 2</div>
                    <h2 class="section-title">RSA Mathematics</h2>
                </div>
                <div class="section-body">
                    <p>Security based on Number Theory: <strong>Factoring large numbers is hard.</strong></p>
                    <div class="math-block">
                        $$ C = M^e \pmod n $$
                        $$ M = C^d \pmod n $$
                    </div>
                    <div class="rule">
                        <strong>Key Generation Protocol:</strong>
                        <br>1. Choose two large primes $p$ and $q$.
                        <br>2. Compute $n = p \times q$. (Public Modulus).
                        <br>3. Compute Euler's Totient $\phi(n) = (p-1)(q-1)$.
                        <br>4. Choose public exponent $e$ such that $1 < e < \phi(n)$ and $GCD(e, \phi(n))=1$. <br>5.
                            Compute private key $d$ such that $d \times e \equiv 1 \pmod{\phi(n)}$. (Modular Inverse).
                    </div>
                    <div class="info">
                        <strong>Why is this secure?</strong>
                        <br>To find $d$, Eve needs $\phi(n)$.
                        <br>To find $\phi(n)$, Eve needs to factor $n$ into $p$ and $q$.
                        <br>If $n$ is 4096 bits, factoring takes billions of years (classically).
                    </div>
                </div>
            </section>

            <!-- Signatures -->
            <section class="section" id="signatures">
                <div class="section-header">
                    <div class="section-number">Section 3</div>
                    <h2 class="section-title">Digital Signatures & Certificates</h2>
                </div>
                <div class="section-body">
                    <p>RSA doesn't just keep secrets; it proves <strong>identity</strong>.</p>
                    <div class="card">
                        <h3>Signing a Document</h3>
                        <p>1. Alice writes a message.</p>
                        <p>2. Alice hashes the message (Creates a fingerprint).</p>
                        <p>3. Alice encrypts the HASH with her <strong>Private Key</strong>.</p>
                        <p>4. Anyone can decrypt it with her Public Key.</p>
                        <p>Result: If it decrypts, Alice MUST have written it. This is <strong>Non-Repudiation</strong>.
                        </p>
                    </div>
                    <div class="warning">
                        <strong>Man-in-the-Middle (MITM) Attack:</strong>
                        <br>Eve sits between Alice and Bob. She gives her public key to Alice (pretending to be Bob) and
                        to Bob (pretending to be Alice). She decrypts, reads, re-encrypts.
                        <br><strong>Solution: Certificate Authorities (CA).</strong> A trusted 3rd party (DigiCert,
                        Let's Encrypt) digitally signs Google's Public Key. Your browser trusts the CA, so it trusts
                        Google.
                    </div>
                </div>
            </section>

            <!-- Hashing -->
            <section class="section" id="hashing">
                <div class="section-header">
                    <div class="section-number">Section 4</div>
                    <h2 class="section-title">Hashing & Salting</h2>
                </div>
                <div class="section-body">
                    <p>A hash function maps data of arbitrary size to fixed-size values.</p>
                    <div class="grid-2col">
                        <div class="card">
                            <h3>Properties</h3>
                            <p>1. <strong>Deterministic:</strong> Same input = Same output.</p>
                            <p>2. <strong>One-Way:</strong> Can't reverse (Un-blend smoothie).</p>
                            <p>3. <strong>Avalanche:</strong> Change 1 bit -> Totally different hash.</p>
                        </div>
                        <div class="card">
                            <h3>Algorithms</h3>
                            <p><strong>MD5:</strong> Broken. Do not use.</p>
                            <p><strong>SHA-256:</strong> Standard. Secure.</p>
                            <p><strong>Bcrypt:</strong> Slow (Good for passwords).</p>
                        </div>
                    </div>
                    <div class="info">
                        <strong>Salting Passwords:</strong>
                        <br>Never store passwords in plain text. Store `Hash(password + random_salt)`.
                        <br>This prevents <strong>Rainbow Table</strong> attacks (precomputed lists of hashes for
                        "password123").
                    </div>
                </div>
            </section>

            <!-- Python -->
            <section class="section" id="python">
                <div class="section-header">
                    <div class="section-number">Section 5</div>
                    <h2 class="section-title">Python: Full RSA</h2>
                </div>
                <div class="section-body">
                    <p>Implementing a toy RSA class with key generation.</p>

                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">Python</span>
                            <span class="code-label">Toy RSA Class</span>
                        </div>
                        <div class="code-content">
                            <pre><code class="language-python">import random

def gcd(a, b):
    while b:
        a, b = b, a % b
    return a

# Extended Euclidean Algorithm to find modular inverse
def mod_inverse(e, phi):
    def extended_gcd(a, b):
        if a == 0:
            return b, 0, 1
        d, x1, y1 = extended_gcd(b % a, a)
        x = y1 - (b // a) * x1
        y = x1
        return d, x, y

    _, x, _ = extended_gcd(e, phi)
    return (x % phi + phi) % phi

class RSA:
    def __init__(self, p, q):
        self.n = p * q
        self.phi = (p - 1) * (q - 1)
        self.e = 65537 # Common choice (2^16 + 1)
        self.d = mod_inverse(self.e, self.phi)
        
    def encrypt(self, message_int):
        return pow(message_int, self.e, self.n)
        
    def decrypt(self, ciphertext_int):
        return pow(ciphertext_int, self.d, self.n)

# Usage
rsa = RSA(61, 53) # Small primes for demo
print(f"Public Key: (e={rsa.e}, n={rsa.n})")
print(f"Private Key: (d={rsa.d})")

msg = 123
encrypted = rsa.encrypt(msg)
decrypted = rsa.decrypt(encrypted)

print(f"Original: {msg} -> Encrypted: {encrypted} -> Decrypted: {decrypted}")
</code></pre>
                        </div>
                    </div>
                </div>
            </section>


            <!-- Videos -->
            <section class="section" id="videos">
                <div class="section-header">
                    <div class="section-number">Section 6</div>
                    <h2 class="section-title">Video Lessons</h2>
                </div>
                <div class="section-body">
                    <div class="video-container">
                        <div class="video-player">
                            <iframe id="ytPlayer" src="" allowfullscreen></iframe>
                            <div class="video-info">
                                <div class="video-title" id="videoTitle">Select a video</div>
                                <div class="video-meta" id="videoMeta"></div>
                            </div>
                        </div>
                        <div class="video-list" id="videoList"></div>
                    </div>
                </div>
            </section>

            <!-- Practice -->
            <section class="section" id="practice">
                <div class="section-header">
                    <div class="section-number">Section 7</div>
                    <h2 class="section-title">Practice Problems</h2>
                </div>
                <div class="section-body">
                    <div class="quiz-controls">
                        <button class="btn btn-primary" id="btnCheckAll">Check All</button>
                        <button class="btn" id="btnRevealAll">Reveal All</button>
                        <button class="btn" id="btnClear">Clear Inputs</button>
                        <button class="btn btn-danger" id="btnReset">Reset Stats</button>
                    </div>
                    <div id="quizContainer"></div>
                </div>
            </section>
        </main>
    </div>

    <script>
        const VIDEO_GROUPS = [
            {
                title: "Public Key Cryptography",
                items: [
                    { title: "Diffie-Hellman Key Exchange", channel: "Computerphile", vid: "Yjrfm_oRO0w" },
                    { title: "RSA Encryption", channel: "Computerphile", vid: "JD72Ry60eP4" },
                    { title: "How RSA Works", channel: "Eddie Woo", vid: "4zahvcJ9glg" },
                    { title: "Prime Numbers in Crypto", channel: "Numberphile", vid: "M7kEpw1tn50" }
                ]
            },
            {
                title: "Web Security",
                items: [
                    { title: "How HTTPS Works", channel: "Computerphile", vid: "w0QbnxKRD0w" },
                    { title: "Digital Signatures", channel: "Computerphile", vid: "s22eJ1eVLTU" },
                    { title: "Man in the Middle Attack", channel: "Computerphile", vid: "yY9K4f9812A" },
                    { title: "Hashing Algorithms", channel: "Computerphile", vid: "DMtFhACPnTY" }
                ]
            },
            {
                title: "Advanced Crypto",
                items: [
                    { title: "Elliptic Curve Cryptography", channel: "Computerphile", vid: "NF1pwjL9-DE" },
                    { title: "Zero Knowledge Proofs", channel: "Computerphile", vid: "HUs1bH85X9I" },
                    { title: "Quantum Computers and Crypto", channel: "Veritasium", vid: "-UrdExQW0cs" },
                    { title: "Password Salting", channel: "Computerphile", vid: "8ZtInClXe1Q" }
                ]
            }
        ];

        initLesson({
            videos: VIDEO_GROUPS,
            questions: window.QUESTIONS_DATA['day35'] || [],
            storageKey: 'day35_v2'
        });
    </script>
    <script>hljs.highlightAll();</script>
</body>

</html>